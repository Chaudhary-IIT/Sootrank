{% extends "faculty_base.html" %}

{% block title %}Courses — {{ faculty.first_name }} {{ faculty.last_name|default_if_none:"" }}{% endblock %}

{% block nav_results_active %} active{% endblock %} {# Or whichever nav item this page belongs to #}

{% block extra_css %}
<style>
  .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
  /* The .card-course:hover style is already defined in faculty_base.html via the .card:hover style */
</style>
{% endblock %}


{% block content %}

<div class="text-center mb-4">
  <h1 class="fs-3 fw-bold mb-1">My Courses</h1>
  <p class="text-muted small mb-0">Select a course to view marks or grading policy</p>
</div>

<div class="bg-white p-3 mb-4 d-flex justify-content-between align-items-center" style="border-radius: var(--radius); box-shadow: var(--shadow-subtle);">
  <form class="d-flex" role="search" onsubmit="return false;">
    <input id="search" class="form-control" type="search" placeholder="Search courses..." />
  </form>
  <span class="text-muted fw-medium">Total: {{ courses|length }}</span>
</div>

{% if courses %}
  <div id="grid" class="row g-4">
    {% for c in courses %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card card-course h-100">
          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <div class="h6 mb-1 mono">{{ c.code }}</div>
                <div class="fw-semibold">{{ c.name }}</div>
              </div>
              
            </div>
            
            <div class="text-muted small mt-2">
              Enrolled: {{ c.enrolled_count|default:"—" }}
            </div>
            
            <div class="mt-auto d-flex gap-2 pt-3">
              <a class="btn btn-outline-primary btn-sm" href="{% url 'course_marks_overview' c.id %}">
                View Marks
              </a>
              <a class="btn btn-primary btn-sm" href="{% url 'assign_grades_csv' c.code %}">
                Grading Policy
              </a>
            </div>
          </div>
          
          <div class="card-footer d-flex justify-content-between small text-muted">
            <span>Credits: {{ c.credits|default:"—" }}</span>
            <span>Slot: {{ c.slot|default:"A" }}</span>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="card">
    <div class="card-body text-center text-muted p-5">
      No courses assigned to you.
    </div>
  </div>
{% endif %}
{% endblock %}


{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function(){
  const input = document.getElementById('search');
  const grid = document.getElementById('grid');
  if (!input || !grid) return;

  input.addEventListener('input', function(){
    const q = this.value.toLowerCase();
    // Select the grid container
    const gridContainer = document.getElementById('grid');
    if (!gridContainer) return;
    
    // Loop over the columns (.col-*) which are the direct children
    gridContainer.querySelectorAll('.col-12').forEach(col => {
      // Find the card inside the column
      const card = col.querySelector('.card-course');
      if (card) {
        const text = card.innerText.toLowerCase();
        // Show/hide the column, which contains the card
        col.style.display = text.includes(q) ? '' : 'none';
      }
    });
  });
});
</script>
{% endblock %}